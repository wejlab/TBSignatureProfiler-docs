<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot a heatmap of signature scores. — signatureHeatmap • TBSignatureProfiler</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot a heatmap of signature scores. — signatureHeatmap" />
<meta property="og:description" content="This function takes a dataset of scored gene expression data as an input
and returns a ComplexHeatmap plot for for visual comparison of
signature performance. The function takes arguments listed here as well
as any others to be passed on to ComplexHeatmap::Heatmap()." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TBSignatureProfiler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/rmd/TBSig_Vignette.html">Command Line Analysis</a>
</li>
<li>
  <a href="../articles/rmd/OriginalModelTutorial.html">Original Models</a>
</li>
<li>
  <a href="../articles/rmd/shinytutorial.html">Interactive Shiny Analysis</a>
</li>
<li>
  <a href="../articles/rmd/SignatureAddition.html">Adding Signatures to the Profiler</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/compbiomed/TBSignatureProfiler">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a heatmap of signature scores.</h1>
    <small class="dont-index">Source: <a href='https://github.com/compbiomed/TBSignatureProfiler/blob/master/R/plot.R'><code>R/plot.R</code></a></small>
    <div class="hidden name"><code>signatureHeatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes a dataset of scored gene expression data as an input
and returns a <code>ComplexHeatmap</code> plot for for visual comparison of
signature performance. The function takes arguments listed here as well
as any others to be passed on to <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>ComplexHeatmap::Heatmap()</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>signatureHeatmap</span><span class='op'>(</span>
  <span class='va'>inputData</span>,
  annotationData <span class='op'>=</span> <span class='cn'>NULL</span>,
  name <span class='op'>=</span> <span class='st'>"Signatures"</span>,
  <span class='va'>signatureColNames</span>,
  annotationColNames <span class='op'>=</span> <span class='cn'>NULL</span>,
  colList <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  scale <span class='op'>=</span> <span class='cn'>FALSE</span>,
  showColumnNames <span class='op'>=</span> <span class='cn'>TRUE</span>,
  showRowNames <span class='op'>=</span> <span class='cn'>TRUE</span>,
  colorSets <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Set1"</span>, <span class='st'>"Set2"</span>, <span class='st'>"Set3"</span>, <span class='st'>"Pastel1"</span>, <span class='st'>"Pastel2"</span>, <span class='st'>"Accent"</span>, <span class='st'>"Dark2"</span>,
    <span class='st'>"Paired"</span><span class='op'>)</span>,
  choose_color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>, <span class='st'>"gray95"</span>, <span class='st'>"red"</span><span class='op'>)</span>,
  split_heatmap <span class='op'>=</span> <span class='st'>"none"</span>,
  annotationSignature <span class='op'>=</span> <span class='va'>sigAnnotData</span>,
  column_order <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>inputData</th>
      <td><p>an input data object. It should either be of the class
<code>SummarizedExperiment</code> and contain the profiled signature data and
annotation data as columns in the colData, or alternatively be of the classes
<code>data.frame</code> or <code>matrix</code> and contain only the gene expression data.
Required.</p></td>
    </tr>
    <tr>
      <th>annotationData</th>
      <td><p>a <code>data.frame</code> or <code>matrix</code> of annotation
data, with one column. Only required if <code>inputData</code> is a
<code>data.frame</code> or <code>matrix</code> of signature data.
The row names must equal those of the <code>inputData</code> column names.
Default is <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>a character string with the plot title of the heatmap. The
default is <code>"Signatures"</code>.</p></td>
    </tr>
    <tr>
      <th>signatureColNames</th>
      <td><p>a vector of the column names in <code>colData</code> that
contain the signature data. Only required if <code>inputData</code> is a
SummarizedExperiment object.</p></td>
    </tr>
    <tr>
      <th>annotationColNames</th>
      <td><p>a vector of the column names in <code>colData</code> that
contain the annotation data. Only required if <code>inputData</code> is a
<code>SummarizedExperiment</code>. Default is <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>colList</th>
      <td><p>a named <code>list</code> of named vectors specifying custom color
information to
pass to <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>ComplexHeatmap::Heatmap()</a></code>. The list should have as many
elements as there are annotation columns, and each element name should
correspond exactly with the name of each annotation column.
The colors in the vector elements should be named according to the
levels of the factor in that column's annotation data if the annotation
is discrete, or it should be produced with <code><a href='https://rdrr.io/pkg/circlize/man/colorRamp2.html'>circlize::colorRamp2</a></code>
if the annotation is continuous.
By default, <code>ColorBrewer</code> color sets will be used.
See the the parameter <code>colorSets</code> for additional details.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>logical. Setting <code>scale = TRUE</code> scales the signature data.
The default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>showColumnNames</th>
      <td><p>logical. Setting <code>showColumnNames = TRUE</code> will
show the column names (i.e. sample names) on the heatmap. The default is
<code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>showRowNames</th>
      <td><p>logical. Setting <code>showColumnNames = TRUE</code> will
show the row names (i.e. signature names) on the heatmap. The default is
<code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>colorSets</th>
      <td><p>a vector of names listing the color sets in the order
that they should be used in creating the heatmap. By default, this function
will use the color sets in the order listed in <code>Usage</code> for annotation
information. You may replace the default with the same collection of sets
in order that you want to use them, or provide custom color sets with the
<code>colList</code> parameter.</p></td>
    </tr>
    <tr>
      <th>choose_color</th>
      <td><p>a vector of color names to be interpolated for the
heatmap gradient, or a <code>colorRamp</code> function produced by
<code><a href='https://rdrr.io/pkg/circlize/man/colorRamp2.html'>circlize::colorRamp2</a></code>. The default is <code><a href='https://rdrr.io/r/base/c.html'>c("blue", "gray95", "red")</a></code>.</p></td>
    </tr>
    <tr>
      <th>split_heatmap</th>
      <td><p>a character string either giving the column title of
<code>annotationSignature</code> containing annotation data for which to split
the heatmap rows (i.e., signatures), or <code>"none"</code> if no split is desired.
To split based on the type of signature, set <code>split_heatmap = "disease"</code>.
The default is <code>"none"</code>.</p></td>
    </tr>
    <tr>
      <th>annotationSignature</th>
      <td><p>a <code>data.frame</code> or <code>matrix</code> with information
to be used
in splitting the heatmap. The first column should signature names. The
column of annotation information should be specified in <code>split_heatmap.</code>
Other columns will be ignored. The default is <code>sigAnnotData</code>.</p></td>
    </tr>
    <tr>
      <th>column_order</th>
      <td><p>a vector of character strings indicating the order in
which to manually arrange the heatmap columns. Default is <code>NULL</code>,
such that column order is automatically determined via clustering.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to be passed to
<code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>ComplexHeatmap::Heatmap()</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A ComplexHeatmap plot.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If both <code>annotationData = NULL</code> and <code>annotationColNames = NULL</code>,
no annotation bar will be drawn on the heatmap.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://bioconductor.org/packages/SummarizedExperiment'>SummarizedExperiment</a></span><span class='op'>)</span>
<span class='co'># Generate some artificial data that shows a difference in Zak_RISK_16</span>
<span class='va'>mat_testdata</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>80</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>80</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>5</span><span class='op'>)</span>, <span class='fl'>16</span>, <span class='fl'>10</span>,
                             dimnames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>TBsignatures</span><span class='op'>$</span><span class='va'>Zak_RISK_16</span>,
                                             <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sample"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,
                      <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>1000</span><span class='op'>)</span>, <span class='fl'>100</span>, <span class='fl'>10</span>,
                             dimnames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"gene"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span>,
                                             <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"sample"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Create a SummarizedExperiment object that contains the data</span>
<span class='va'>testdataSE</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html'>SummarizedExperiment</a></span><span class='op'>(</span>assays <span class='op'>=</span> <span class='fu'>SimpleList</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>mat_testdata</span><span class='op'>)</span>,
                                     colData <span class='op'>=</span> <span class='fu'>DataFrame</span><span class='op'>(</span>sample <span class='op'>=</span>
                                                           <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"down"</span>, <span class='fl'>5</span><span class='op'>)</span>,
                                                                <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"up"</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='runTBsigProfiler.html'>runTBsigProfiler</a></span><span class='op'>(</span><span class='va'>testdataSE</span>, useAssay <span class='op'>=</span> <span class='st'>"data"</span>,
                        signatures <span class='op'>=</span> <span class='va'>TBsignatures</span><span class='op'>[</span><span class='st'>"Zak_RISK_16"</span><span class='op'>]</span>,
                        algorithm <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GSVA"</span>, <span class='st'>"ssGSEA"</span><span class='op'>)</span>, parallel.sz <span class='op'>=</span> <span class='fl'>1</span>,
                        combineSigAndAlgorithm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Running GSVA</span></div><div class='output co'>#&gt; Estimating GSVA scores for 1 gene sets.
#&gt; Estimating ECDFs with Gaussian kernels
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%
#&gt; </div><div class='output co'>#&gt; <span class='message'>Running ssGSEA</span></div><div class='output co'>#&gt; Estimating ssGSEA scores for 1 gene sets.
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%
#&gt; </div><div class='input'><span class='fu'>signatureHeatmap</span><span class='op'>(</span><span class='va'>res</span>, signatureColNames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GSVA_Zak_RISK_16"</span>,
                                            <span class='st'>"ssGSEA_Zak_RISK_16"</span><span class='op'>)</span>,
                 annotationColNames <span class='op'>=</span> <span class='st'>"sample"</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>,
                 showColumnNames <span class='op'>=</span> <span class='cn'>FALSE</span>, split_heatmap <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>
</div><div class='img'><img src='signatureHeatmap-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Example using custom colors for the annotation information</span>
<span class='va'>color2</span> <span class='op'>&lt;-</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"purple"</span>, <span class='st'>"black"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"down"</span>, <span class='st'>"up"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>color.list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"sample"</span> <span class='op'>=</span> <span class='va'>color2</span><span class='op'>)</span>

<span class='fu'>signatureHeatmap</span><span class='op'>(</span><span class='va'>res</span>, signatureColNames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GSVA_Zak_RISK_16"</span>,
                                            <span class='st'>"ssGSEA_Zak_RISK_16"</span><span class='op'>)</span>,
                 annotationColNames <span class='op'>=</span> <span class='st'>"sample"</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>,
                 showColumnNames <span class='op'>=</span> <span class='cn'>FALSE</span>,
                 colList <span class='op'>=</span> <span class='va'>color.list</span>, split_heatmap <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>
</div><div class='img'><img src='signatureHeatmap-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Jenkins, Aubrey Odom, Xutao Wang, Yue Zhao, W. Evan Johnson, Christian Love.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


