<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="TBSignatureProfiler">
<title>Introduction to the TBSignatureProfiler • TBSignatureProfiler</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Introduction to the TBSignatureProfiler">
<meta property="og:description" content="TBSignatureProfiler">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">TBSignatureProfiler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.15.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../index.html">Home</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../../articles/rmd/TBSig_Vignette.html">Command Line Analysis</a>
    <a class="dropdown-item" href="../../articles/rmd/OriginalModelTutorial.html">Original Models</a>
    <a class="dropdown-item" href="../../articles/rmd/shinytutorial.html">Interactive Shiny Analysis</a>
    <a class="dropdown-item" href="../../articles/rmd/SignatureAddition.html">Adding Signatures to the Profiler</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Function Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">TBSP News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/wejlab/TBSignatureProfiler">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="TBSig_Vignette_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="TBSig_Vignette_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="TBSig_Vignette_files/datatables-binding-0.28/datatables.js"></script><link href="TBSig_Vignette_files/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="TBSig_Vignette_files/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="TBSig_Vignette_files/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="TBSig_Vignette_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="TBSig_Vignette_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to the TBSignatureProfiler</h1>
                        <h4 data-toc-skip class="author">Aubrey
Odom</h4>
            <address class="author_afil">
      Program in Bioinformatics, Boston University, Boston,
MA<br><a class="author_email" href="mailto:#"></a><a href="mailto:aodom@bu.edu" class="email">aodom@bu.edu</a>
      </address>
                              <h4 data-toc-skip class="author">W. Evan
Johnson</h4>
            <address class="author_afil">
      Division of Infectious Disease, Center for Data Science, Rutgers
University – New Jersey Medical School, Newark, NJ,
USA<br><a class="author_email" href="mailto:#"></a><a href="mailto:wj183@njms.rutgers.edu" class="email">wj183@njms.rutgers.edu</a>
      </address>
                  
            <h4 data-toc-skip class="date">April 4, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wejlab/TBSignatureProfiler/blob/HEAD/vignettes/rmd/TBSig_Vignette.Rmd" class="external-link"><code>vignettes/rmd/TBSig_Vignette.Rmd</code></a></small>
      <div class="d-none name"><code>TBSig_Vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-to-the-tbsignatureprofiler">Introduction to the TBSignatureProfiler<a class="anchor" aria-label="anchor" href="#introduction-to-the-tbsignatureprofiler"></a>
</h2>
<p>Tuberculosis (TB) is the leading cause of infectious disease
mortality worldwide, causing on average nearly 1.4 million deaths per
year. A consistent issue faced in controlling TB outbreak is difficulty
in diagnosing individuals with particular types of TB infections for
which bacteria tests (e.g., via GeneXpert, sputum) prove inaccurate. As
an alternative mechanism of diagnosis for these infections, researchers
have discovered and published multiple gene expression signatures as
blood-based disease biomarkers. In this context, gene signatures are
defined as a combined group of genes with a uniquely characteristic
pattern of gene expression that occurs as a result of a medical
condition. To date, more than 75 signatures have been published by
researchers, though most have relatively low cross-condition validation
(e.g., testing TB in samples from diverse geographic and comorbidity
backgrounds). Furthermore, these signatures have never been formally
collected and made available as a single unified resource.</p>
<p>We aim to provide the scientific community with a resource to access
these aggregated signatures and to create an efficient means for their
visual and quantitative comparison via open source software. This
necessitated the development of the TBSignatureProfiler, a novel R
package which delivers a computational profiling platform for
researchers to characterize the diagnostic ability of existing
signatures in multiple comorbidity settings. This software allows for
signature strength estimation via several enrichment methods and
subsequent visualization of single- and multi-pathway results. Its
signature evaluation functionalities include signature profiling, AUC
bootstrapping, and leave-one-out cross-validation (LOOCV) of logistic
regression to approximate TB samples’ status. Its plotting
functionalities include sample-signature score heatmaps, bootstrap AUC
and LOOCV boxplots, and tables for presenting results.</p>
<p>More recently, the TBSignatureProfiler has undertaken a new role in
analyzing signatures across multiple chronic airway diseases, the most
recent being COVID-19 (see the <code>COVIDsignatures</code> object). As
we grow and expand the TBSignatureProfiler, we hope to add signatures
from multiple diseases to improve the package’s utility in the area of
gene signature comparison.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>In order to install the TBSignatureProfiler from Bioconductor, run
the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"TBSignatureProfiler"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compatibility-with-summarizedexperiment-objects">Compatibility with SummarizedExperiment objects<a class="anchor" aria-label="anchor" href="#compatibility-with-summarizedexperiment-objects"></a>
</h2>
<p>While the TBSignatureProfiler often allows for the form of a
<code>data.frame</code> or <code>matrix</code> as input data, the most
ideal form of input for this package is that of the
<code>SummarizedExperiment</code> object. This is an amazing data
structure that is being developed by the Bioconductor team as part of
the <em><a href="https://bioconductor.org/packages/3.17/SummarizedExperiment" class="external-link">SummarizedExperiment</a></em>
package. It is able to store data matrices along with annotation
information, metadata, and reduced dimensionality data (PCA, t-SNE,
etc.). To learn more about proper usage and context of the
<code>SummarizedExperiment</code> object, you may want to take a look at
the <a href="https://bioconductor.org/packages/release/bioc/vignettes/SummarizedExperiment/inst/doc/SummarizedExperiment.html" class="external-link">package
vignette</a>. A basic understanding of the <code>assay</code> and
<code>colData</code> properties of a <code>SummarizedExperiment</code>
will be useful for the purposes of this vignette.</p>
<p>To install the <code>SummarizedExperiment</code> package, run the
following code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"SummarizedExperiment"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-tutorial-for-the-tbsignatureprofiler">A Tutorial for the TBSignatureProfiler<a class="anchor" aria-label="anchor" href="#a-tutorial-for-the-tbsignatureprofiler"></a>
</h2>
<div class="section level3">
<h3 id="load-packages">Load packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wejlab/TBSignatureProfiler" class="external-link">TBSignatureProfiler</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-shiny-app">Run Shiny App<a class="anchor" aria-label="anchor" href="#run-shiny-app"></a>
</h3>
<p>This command is to start the TBSignatureProfiler shiny app. The Shiny
app implements several functions described in this vignette.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/TBSPapp.html">TBSPapp</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The basic functions of the shiny app are also included in the command
line version of the TBSignatureProfiler, which is the focus of the
remainder of this vignette.</p>
</div>
<div class="section level3">
<h3 id="load-dataset-from-a-summarizedexperiment-object">Load dataset from a SummarizedExperiment object<a class="anchor" aria-label="anchor" href="#load-dataset-from-a-summarizedexperiment-object"></a>
</h3>
<p>In this tutorial, we will work with HIV and Tuberculosis (TB) gene
expression data in a <code>SummarizedExperiment</code> format. This
dataset is included in the TBSignatureProfiler package and can be loaded
into the global environment with <code>data("TB_hiv")</code>. The 31
samples in the dataset are marked as either having both TB and HIV
infection, or HIV infection only.</p>
<p>We begin by examining the dataset, which contains a matrix of counts
information (an “assay” in SummarizedExperiment terms) and another
matrix of meta data information on our samples (the “colData”). We will
also generate a few additional assays; these are the log(counts), the
counts per million (CPM) reads mapped, and the log(CPM) assays.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## HIV/TB gene expression data, included in the package</span></span>
<span><span class="va">hivtb_data</span> <span class="op">&lt;-</span> <span class="va">TB_hiv</span></span>
<span></span>
<span><span class="co">### Note that we have 25,369 genes, 33 samples, and 1 assay of counts</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">hivtb_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 25369    31</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We start with only one assay</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assays</a></span><span class="op">(</span><span class="va">hivtb_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of length 1</span></span>
<span><span class="co">## names(1): counts</span></span></code></pre>
<p>We now make a log counts, CPM and log CPM assay.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Make a log counts, CPM and log CPM assay</span></span>
<span><span class="va">hivtb_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/mkAssay.html">mkAssay</a></span><span class="op">(</span><span class="va">hivtb_data</span>, log <span class="op">=</span> <span class="cn">TRUE</span>, counts_to_CPM <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Check to see that we now have 4 assays</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assays</a></span><span class="op">(</span><span class="va">hivtb_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## List of length 4</span></span>
<span><span class="co">## names(4): counts log_counts counts_cpm log_counts_cpm</span></span></code></pre>
</div>
<div class="section level3">
<h3 class="tabset" id="profile-the-data">Profile the data<a class="anchor" aria-label="anchor" href="#profile-the-data"></a>
</h3>
<p>The TBSignatureProfiler enables comparison of multiple Tuberculosis
gene signatures. The package currently contains information on 79
signatures for comparison. The default signature list object for most
functions here is <code>TBsignatures</code>, although a list with
publication-given signature names is also available in the
<code>TBcommon</code> object. Data frames of annotation information for
these signatures, including information on associated disease and tissue
type, can be accessed as <code>sigAnnotData</code> and
<code>common_sigAnnotData</code> respectively.</p>
<p>With the <code>runTBSigProfiler</code> function, we are able to score
these signatures with a selection of algorithms, including <a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-7" class="external-link">gene
set variation analysis</a> (GSVA) (Hänzelmann et al, 2013), <a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-7" class="external-link">single-sample
GSEA</a> (ssGSEA) (Barbie et al, 2009), and the <a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-14-7" class="external-link">ASSIGN</a>
pathway profiling toolkit (Shen et al, 2015). For a complete list of
included scoring methods, run <code><a href="../../reference/runTBsigProfiler.html">?runTBsigProfiler</a></code> in the
terminal.</p>
<p>Here, we evaluate all signatures included in the package with ssGSEA.
Paraphrasing from the <a href="http://software.broadinstitute.org/cancer/software/genepattern/modules/docs/ssGSEAProjection/4" class="external-link">ssGSEA
documentation</a>, for each pairing of one of the 31 samples and its
gene set, ssGSEA calculates a separate enrichment score independent of
the phenotypic labeling (in this case, whether a sample has HIV/TB, or
HIV only). The single sample’s gene expression profile is then
transformed to a gene set enrichment profile. A score from the set
profile represents the activity level of the biological process in which
the gene set’s members are coordinately up- or down-regulated.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## List all signatures in the profiler</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"TBsignatures"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TBsignatures</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Anderson_42"       "Anderson_OD_51"    "Berry_393"        </span></span>
<span><span class="co">##  [4] "Berry_OD_86"       "Blankley_380"      "Blankley_5"       </span></span>
<span><span class="co">##  [7] "Bloom_OD_144"      "Bloom_RES_268"     "Bloom_RES_558"    </span></span>
<span><span class="co">## [10] "Chen_5"            "Chen_HIV_4"        "Chendi_HIV_2"     </span></span>
<span><span class="co">## [13] "Darboe_RISK_11"    "Dawany_HIV_251"    "Duffy_23"         </span></span>
<span><span class="co">## [16] "Esmail_203"        "Esmail_82"         "Esmail_OD_893"    </span></span>
<span><span class="co">## [19] "Estevez_133"       "Estevez_259"       "Francisco_OD_2"   </span></span>
<span><span class="co">## [22] "Gjoen_10"          "Gjoen_7"           "Gliddon_2_OD_4"   </span></span>
<span><span class="co">## [25] "Gliddon_HIV_3"     "Gliddon_OD_3"      "Gliddon_OD_4"     </span></span>
<span><span class="co">## [28] "Gong_OD_4"         "Heycken_FAIL_22"   "Hoang_OD_13"      </span></span>
<span><span class="co">## [31] "Hoang_OD_20"       "Hoang_OD_3"        "Huang_OD_13"      </span></span>
<span><span class="co">## [34] "Jacobsen_3"        "Jenum_8"           "Kaforou_27"       </span></span>
<span><span class="co">## [37] "Kaforou_OD_44"     "Kaforou_OD_53"     "Kaul_3"           </span></span>
<span><span class="co">## [40] "Kulkarni_HIV_2"    "Kwan_186"          "LauxdaCosta_OD_3" </span></span>
<span><span class="co">## [43] "Lee_4"             "Leong_24"          "Leong_RISK_29"    </span></span>
<span><span class="co">## [46] "Long_RES_10"       "Maertzdorf_15"     "Maertzdorf_4"     </span></span>
<span><span class="co">## [49] "Maertzdorf_OD_100" "Natarajan_7"       "PennNich_RISK_6"  </span></span>
<span><span class="co">## [52] "Qian_OD_17"        "Rajan_HIV_5"       "Roe_3"            </span></span>
<span><span class="co">## [55] "Roe_OD_4"          "Sambarey_HIV_10"   "Singhania_OD_20"  </span></span>
<span><span class="co">## [58] "Sivakumaran_11"    "Sloot_HIV_2"       "Suliman_4"        </span></span>
<span><span class="co">## [61] "Suliman_RISK_2"    "Suliman_RISK_4"    "Sweeney_OD_3"     </span></span>
<span><span class="co">## [64] "Tabone_OD_11"      "Tabone_RES_25"     "Tabone_RES_27"    </span></span>
<span><span class="co">## [67] "Thompson_9"        "Thompson_FAIL_13"  "Thompson_RES_5"   </span></span>
<span><span class="co">## [70] "Tornheim_71"       "Tornheim_RES_25"   "Vargas_18"        </span></span>
<span><span class="co">## [73] "Vargas_42"         "Verhagen_10"       "Walter_51"        </span></span>
<span><span class="co">## [76] "Walter_PNA_119"    "Walter_PNA_47"     "Zak_RISK_16"      </span></span>
<span><span class="co">## [79] "Zhao_NANO_6"</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## We can use all of these signatures for further analysis</span></span>
<span><span class="va">siglist_hivtb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TBsignatures</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Run the TBSignatureProfiler to score the signatures in the data</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="va">ssgsea_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/runTBsigProfiler.html">runTBsigProfiler</a></span><span class="op">(</span>input <span class="op">=</span> <span class="va">hivtb_data</span>,</span>
<span>                                                 useAssay <span class="op">=</span> <span class="st">"log_counts_cpm"</span>,</span>
<span>                                                 signatures <span class="op">=</span> <span class="va">TBsignatures</span>,</span>
<span>                                                 algorithm <span class="op">=</span> <span class="st">"ssGSEA"</span>,</span>
<span>                                                 combineSigAndAlgorithm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                                 parallel.sz <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Parameter update_genes is TRUE. Gene names will be updated.</span></span></code></pre>
<pre><code><span><span class="co">## The following signatures have &lt;2 genes that coincide with the genes in the given sample and will not be scored: Chendi_HIV_2</span></span></code></pre>
<pre><code><span><span class="co">## Running ssGSEA</span></span></code></pre>
<pre><code><span><span class="co">## Warning: no function found corresponding to methods exports from 'HDF5Array'</span></span>
<span><span class="co">## for: 'extract_sparse_array'</span></span></code></pre>
<pre><code><span><span class="co">## Warning: multiple methods tables found for 'sparsity'</span></span></code></pre>
<pre><code><span><span class="co">## Warning in .filterGenes(dataMatrix, dropConstantRows = FALSE): 2204 rows with</span></span>
<span><span class="co">## constant values throughout the samples.</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Remove any signatures that were not scored</span></span>
<span><span class="va">TBsignatures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">TBsignatures</span>, <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TBsignatures</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chendi_HIV_2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>When a <code>SummarizedExperiment</code> is the format of the input
data for <code>runTBsigprofiler</code>, the returned object is also of
the <code>SummarizedExperiment</code>. The scores will be returned as a
part of the colData.</p>
<p>Below, we subset the data to compare the enrichment scores for the
Anderson_42, Anderson_OD_51, and Zak_RISK_16 signatures.</p>
<p>Signature Scores</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## New colData entries from the Profiler</span></span>
<span><span class="va">sigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Anderson_42"</span>, <span class="st">"Anderson_OD_51"</span>, <span class="st">"Zak_RISK_16"</span><span class="op">)</span></span>
<span><span class="va">ssgsea_print_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">ssgsea_result</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Disease"</span>, <span class="va">sigs</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">ssgsea_print_results</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ssgsea_print_results</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">ssgsea_print_results</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-f57894da2a8185312202" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f57894da2a8185312202">{"x":{"filter":"none","vertical":false,"data":[["R01_1","R01_10","R01_11","R01_12","R01_13","R01_14","R01_15","R01_16","R01_2","R01_3","R01_4","R01_5","R01_6","R01_7","R01_8","R01_9","R02_17","R02_18","R02_19","R02_20","R02_21","R02_22","R02_23","R02_24","R02_25","R02_26","R02_27","R02_28","R02_29","R02_30","R02_31"],["tb_hiv","tb_hiv","tb_hiv","tb_hiv","tb_hiv","tb_hiv","tb_hiv","hiv_only","tb_hiv","tb_hiv","tb_hiv","tb_hiv","tb_hiv","tb_hiv","tb_hiv","tb_hiv","hiv_only","hiv_only","hiv_only","hiv_only","hiv_only","hiv_only","hiv_only","hiv_only","hiv_only","hiv_only","hiv_only","hiv_only","hiv_only","hiv_only","hiv_only"],[0.2248,0.2049,0.1841,0.2053,0.1923,0.1988,0.2261,0.2204,0.218,0.1911,0.1753,0.2031,0.2069,0.2015,0.1916,0.2114,0.2115,0.2234,0.2233,0.2142,0.2401,0.197,0.2208,0.2214,0.2071,0.2267,0.2027,0.204,0.2128,0.2058,0.1877],[0.23,0.2834,0.2481,0.2493,0.264,0.2806,0.2881,0.237,0.2644,0.2796,0.2665,0.2439,0.2478,0.2401,0.2528,0.2618,0.2482,0.2042,0.2341,0.2392,0.2402,0.2596,0.248,0.2468,0.2437,0.2392,0.2295,0.2606,0.2724,0.252,0.2444],[0.4584,0.4939,0.4448,0.4863,0.4999,0.4967,0.4784,0.3774,0.4286,0.4777,0.4834,0.4686,0.4715,0.4985,0.4953,0.4939,0.4264,0.3766,0.3881,0.4115,0.3671,0.4267,0.3991,0.4321,0.4019,0.4201,0.4035,0.4985,0.4831,0.4613,0.425]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Disease<\/th>\n      <th>Anderson_42<\/th>\n      <th>Anderson_OD_51<\/th>\n      <th>Zak_RISK_16<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 class="tabset" id="visualization-with-tbsignatureprofiler-plots">Visualization with TBSignatureProfiler Plots<a class="anchor" aria-label="anchor" href="#visualization-with-tbsignatureprofiler-plots"></a>
</h3>
<div class="section level4">
<h4 id="heatmap-with-all-signatures">Heatmap with all Signatures<a class="anchor" aria-label="anchor" href="#heatmap-with-all-signatures"></a>
</h4>
<p>Commonly, enrichment scores are compared across signatures by means
of a heatmap combined with clustering methods to group samples and/or
scores. The <code>signatureHeatmap</code> function uses the information
from the score data to visualize changes in gene expression across
samples and signatures (or genes, if only one signature is
selected).</p>
<p>Here, the columns of the heatmap represent samples, and rows
represent signatures. Rows are split according to annotation data with
associated signature disease type. As we move across the columns, we see
different patterns of gene expression as indicated by the varying color
and intensity of individual rectangles. In the top bar, the solid red
represents a sample is HIV infected only, and solid blue indicates that
the sample is both HIV and TB infected. In the gradient area of the
heatmap, the scaled scores are associated with either up-regulated or
down-regulated genes.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Colors for gradient</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">"Spectral"</span><span class="op">)</span></span>
<span><span class="va">col.me</span> <span class="op">&lt;-</span> <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                   length.out <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, <span class="va">colors</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../../reference/signatureHeatmap.html">signatureHeatmap</a></span><span class="op">(</span><span class="va">ssgsea_result</span>, name <span class="op">=</span> <span class="st">"Heatmap of Signatures,</span></span>
<span><span class="st">                 ssGSEA Algorithm"</span>,</span>
<span>                 signatureColNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TBsignatures</span><span class="op">)</span>,</span>
<span>                 annotationColNames <span class="op">=</span> <span class="st">"Disease"</span>,</span>
<span>                 scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 showColumnNames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 choose_color <span class="op">=</span> <span class="va">col.me</span><span class="op">)</span></span></code></pre></div>
<p><img src="TBSig_Vignette_files/figure-html/all_sigs_heatmap-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="boxplots-of-scores-all-signatures">Boxplots of Scores, All Signatures<a class="anchor" aria-label="anchor" href="#boxplots-of-scores-all-signatures"></a>
</h4>
<p>Another method of visualization for scores is that of boxplots. When
multiple signatures in the input data are to be compared, the
<code>signatureBoxplot</code> function takes the scores for each
signature and produces an individual boxplot, with jittered points
representing individual sample scores. For this specific example, it is
clear that some signatures do a better job at differentiating the TB/HIV
and HIV only samples than others, as seen by overlapping or separate
spreads of the adjacent boxplots.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/signatureBoxplot.html">signatureBoxplot</a></span><span class="op">(</span>inputData <span class="op">=</span> <span class="va">ssgsea_result</span>,</span>
<span>                 name <span class="op">=</span> <span class="st">"Boxplots of Signatures, ssGSEA"</span>,</span>
<span>                 signatureColNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TBsignatures</span><span class="op">)</span>,</span>
<span>                 annotationColName <span class="op">=</span> <span class="st">"Disease"</span>, rotateLabels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span>
<span><span class="co">## Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Score` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Score` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Score` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Score` instead.</span></span></code></pre>
<p><img src="TBSig_Vignette_files/figure-html/Boxplots_all-1.png" width="1440"></p>
</div>
<div class="section level4">
<h4 class="tabset" id="boxplots-of-scores-individual-signatures">Boxplots of Scores, Individual Signatures<a class="anchor" aria-label="anchor" href="#boxplots-of-scores-individual-signatures"></a>
</h4>
<p>If only one boxplot of a signature is desired, then that signature
alone should be specified in <code>signatureColNames</code>. Otherwise,
an array of plots for all signatures will be produced. Here we use the
signatures Anderson_42, Anderson_OD_51, and Zak_RISK_16.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">sigs</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"####"</span>, <span class="va">i</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../../reference/signatureBoxplot.html">signatureBoxplot</a></span><span class="op">(</span><span class="va">ssgsea_result</span>, name <span class="op">=</span> <span class="va">i</span>, signatureColNames <span class="op">=</span> <span class="va">i</span>,</span>
<span>                 annotationColName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Disease"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level5">
<h5 id="anderson_42">Anderson_42<a class="anchor" aria-label="anchor" href="#anderson_42"></a>
</h5>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span>
<span><span class="co">## Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Score` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Score` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Score` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Score` instead.</span></span></code></pre>
<p><img src="TBSig_Vignette_files/figure-html/Boxplots_indiv-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="anderson_od_51">Anderson_OD_51<a class="anchor" aria-label="anchor" href="#anderson_od_51"></a>
</h5>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Score` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Score` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Score` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Score` instead.</span></span></code></pre>
<p><img src="TBSig_Vignette_files/figure-html/Boxplots_indiv-2.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="zak_risk_16">Zak_RISK_16<a class="anchor" aria-label="anchor" href="#zak_risk_16"></a>
</h5>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Score` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Score` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Group` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Group` instead.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Use of `boxplotdfm$Score` is discouraged.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `Score` instead.</span></span></code></pre>
<p><img src="TBSig_Vignette_files/figure-html/Boxplots_indiv-3.png" width="700"></p>
</div>
</div>
<div class="section level4">
<h4 class="tabset" id="heatmaps-for-individual-signatures">Heatmaps for Individual Signatures<a class="anchor" aria-label="anchor" href="#heatmaps-for-individual-signatures"></a>
</h4>
<p>The <code>signatureGeneHeatmap</code> function produces heatmaps that
highlight a single selected signature. The resulting plots feature
samples on the columns, and the genes in the signature on the rows. The
annotation rows at the top are related to both the disease phenotype and
to the signature score itself. The gradient of the heatmap is created
using the gene expression values in the assay specified by the
<code>useAssay</code> parameter. Here, we observe how the log(CPM)
values for specific genes relate to the signature score for each sample
using the signatures Anderson_42, Anderson_OD_51, and Zak_RISK_16.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">sigs</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"####"</span>, <span class="va">i</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="../../reference/signatureGeneHeatmap.html">signatureGeneHeatmap</a></span><span class="op">(</span>inputData <span class="op">=</span> <span class="va">ssgsea_result</span>, useAssay <span class="op">=</span> <span class="st">"log_counts_cpm"</span>,</span>
<span>                       <span class="va">TBsignatures</span><span class="op">[</span><span class="va">sigs</span><span class="op">]</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       name <span class="op">=</span> <span class="va">i</span>, signatureColNames <span class="op">=</span> <span class="va">i</span>,</span>
<span>                       annotationColNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Disease"</span><span class="op">)</span>,</span>
<span>                       showColumnNames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       choose_color <span class="op">=</span> <span class="va">col.me</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level5">
<h5 id="anderson_42-1">Anderson_42<a class="anchor" aria-label="anchor" href="#anderson_42-1"></a>
</h5>
<p><img src="TBSig_Vignette_files/figure-html/Heatmaps_indiv-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="anderson_od_51-1">Anderson_OD_51<a class="anchor" aria-label="anchor" href="#anderson_od_51-1"></a>
</h5>
<p><img src="TBSig_Vignette_files/figure-html/Heatmaps_indiv-2.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="zak_risk_16-1">Zak_RISK_16<a class="anchor" aria-label="anchor" href="#zak_risk_16-1"></a>
</h5>
<p><img src="TBSig_Vignette_files/figure-html/Heatmaps_indiv-3.png" width="700"></p>
</div>
</div>
<div class="section level4">
<h4 id="compare-scoring-methods-for-a-single-signature">Compare scoring methods for a single signature<a class="anchor" aria-label="anchor" href="#compare-scoring-methods-for-a-single-signature"></a>
</h4>
<p>The <code>compareAlgs</code> function allows multiple scoring methods
to be compared via a heatmap or boxplot with samples on the columns and
methods on the rows. Here, we compare scoring methods for the
“Tabone_RES_25” signature. It seems that singscore may be the best
method here, as its sample scores most closely align with the
information provided by the annotation data.</p>
<p>An examination of the boxplot and heatmap together determine that
PLAGE and the comparing Z-score methods are least helpful in correctly
identifying TB from LTBI subjects, although still quite good - average
AUC scores are a little less than 0.8 and subjects in different groups
are falsely assigned similar scores. According to the boxplot, we see
that singscore has the highest predictive AUC next to ssGSEA.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Heatmap</span></span>
<span><span class="fu"><a href="../../reference/compareAlgs.html">compareAlgs</a></span><span class="op">(</span><span class="va">hivtb_data</span>, annotationColName <span class="op">=</span> <span class="st">"Disease"</span>,</span>
<span>            scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GSVA"</span>, <span class="st">"ssGSEA"</span>,</span>
<span>                          <span class="st">"singscore"</span>, <span class="st">"PLAGE"</span>, <span class="st">"Zscore"</span><span class="op">)</span>,</span>
<span>            useAssay <span class="op">=</span> <span class="st">"log_counts"</span>,</span>
<span>            signatures <span class="op">=</span> <span class="va">TBsignatures</span><span class="op">[</span><span class="st">"Tabone_RES_25"</span><span class="op">]</span>,</span>
<span>            choose_color <span class="op">=</span> <span class="va">col.me</span>, show.pb <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            parallel.sz <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="TBSig_Vignette_files/figure-html/compareAlgs_ex-1.png" width="700"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Boxplot</span></span>
<span><span class="fu"><a href="../../reference/compareAlgs.html">compareAlgs</a></span><span class="op">(</span><span class="va">hivtb_data</span>, annotationColName <span class="op">=</span> <span class="st">"Disease"</span>,</span>
<span>            scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GSVA"</span>, <span class="st">"ssGSEA"</span>,</span>
<span>                          <span class="st">"singscore"</span>, <span class="st">"PLAGE"</span>, <span class="st">"Zscore"</span><span class="op">)</span>,</span>
<span>            useAssay <span class="op">=</span> <span class="st">"log_counts"</span>,</span>
<span>            signatures <span class="op">=</span> <span class="va">TBsignatures</span><span class="op">[</span><span class="st">"Tabone_RES_25"</span><span class="op">]</span>,</span>
<span>            choose_color <span class="op">=</span> <span class="va">col.me</span>, show.pb <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            parallel.sz <span class="op">=</span> <span class="fl">1</span>, output <span class="op">=</span> <span class="st">"boxplot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="TBSig_Vignette_files/figure-html/compareAlgs_ex-2.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 class="tabset" id="comparing-scores-via-bootstrapped-aucs">Comparing scores via bootstrapped AUCs<a class="anchor" aria-label="anchor" href="#comparing-scores-via-bootstrapped-aucs"></a>
</h3>
<div class="section level4">
<h4 id="table-with-t-tests-auc">Table with T-tests &amp; AUC<a class="anchor" aria-label="anchor" href="#table-with-t-tests-auc"></a>
</h4>
<p>The <code>TableAUC</code> function creates a table of useful
information regarding the scored signatures. First, a 2-sample t-test is
conducted on the scores with the TB/HIV status as the response variable.
This is intended to give one metric of whether the signature is a
valuable identifier of the disease phenotype. The log-scaled p-values
are provided for easier means of comparison.</p>
<p>The table also gives the AUC values for the signature scores, along
with confidence intervals derived from bootstrapping. Most AUC estimates
are fairly high.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/tableAUC.html">tableAUC</a></span><span class="op">(</span><span class="va">ssgsea_result</span>,</span>
<span>         annotationColName <span class="op">=</span> <span class="st">"Disease"</span>,</span>
<span>         signatureColNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TBsignatures</span><span class="op">)</span>,</span>
<span>         num.boot <span class="op">=</span> <span class="fl">100</span>,</span>
<span>         pb.show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-a6f0d094c9aab782d2e6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a6f0d094c9aab782d2e6">{"x":{"filter":"none","vertical":false,"data":[["Kulkarni_HIV_2","Tabone_RES_25","Tabone_RES_27","Vargas_42","Thompson_9","Hoang_OD_3","Long_RES_10","Blankley_5","Vargas_18","Heycken_FAIL_22","Kaul_3","Hoang_OD_13","Blankley_380","Bloom_OD_144","Bloom_RES_268","Gong_OD_4","Hoang_OD_20","Kaforou_27","Sweeney_OD_3","Darboe_RISK_11","Kwan_186","Rajan_HIV_5","Walter_51","Zak_RISK_16","Tornheim_RES_25","Gliddon_2_OD_4","Gliddon_OD_4","Maertzdorf_15","Roe_3","Tabone_OD_11","Bloom_RES_558","Natarajan_7","Berry_393","Esmail_OD_893","Suliman_4","Sambarey_HIV_10","Estevez_259","Tornheim_71","Estevez_133","Kaforou_OD_53","Gliddon_HIV_3","Gliddon_OD_3","Esmail_203","LauxdaCosta_OD_3","Roe_OD_4","Maertzdorf_OD_100","Thompson_FAIL_13","Thompson_RES_5","Qian_OD_17","Suliman_RISK_2","Walter_PNA_47","Gjoen_7","Kaforou_OD_44","Anderson_OD_51","Jacobsen_3","Chen_5","Duffy_23","Walter_PNA_119","Esmail_82","Leong_RISK_29","Anderson_42","Francisco_OD_2","Sloot_HIV_2","Verhagen_10","Leong_24","Chen_HIV_4","Huang_OD_13","Dawany_HIV_251","Maertzdorf_4","PennNich_RISK_6","Berry_OD_86","Singhania_OD_20","Gjoen_10","Zhao_NANO_6","Suliman_RISK_4","Jenum_8","Sivakumaran_11","Lee_4"],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0001,0.0003,0.0003,0,0,0,0,0,0,0.0001,0.0001,0.0001,0.0001,0.0001,0.0004,0.0012,0.0001,0.0001,0.0029,0.0014,0.0005,0.0017,0.0009,0.0054,0.0061,0.0068,0.0028,0.0028,0.0106,0.009599999999999999,0.0072,0.0158,0.0156,0.0054,0.0207,0.0164,0.0278,0.0481,0.0796,0.0646,0.0586,0.3052,0.1079,0.0851,0.136,0.1372,0.2392,0.1568,0.2231,0.5014,0.2538,0.6886,0.8756,0.5818],[207.1333,147.1411,159.7707,144.8921,148.0662,178.9241,124.934,142.9362,134.5597,142.831,152.3353,122.5744,120.0574,117.3455,128.1118,104.3571,118.0494,119.7161,101.7419,115.2059,109.6654,115.8811,112.2158,114.8476,97.1836,81.48,81.48,125.3667,101.7238,114.0826,107.4439,104.6666,104.6517,88.2056,90.7221,91.1867,91.6613,90.3759,78.3694,67.051,92.9589,92.9589,58.5309,65.9242,75.6901,63.5168,70.17700000000001,52.1894,50.922,49.8912,58.9577,58.9179,45.4278,46.4517,49.288,41.4523,41.6131,52.2314,38.7825,41.1099,35.8293,30.3504,25.3075,27.3968,28.3698,11.8671,22.2662,24.6388,19.9503,19.8657,14.3044,18.5306,15.0028,6.9026,13.7115,3.7304,1.3282,5.416],[0.9631,0.8818,0.8939,0.8731,0.8673,0.8514,0.8502,0.8383,0.854,0.8484,0.8338,0.8209,0.7944,0.8022,0.8139,0.7665,0.8209,0.7774,0.7991,0.7818000000000001,0.7489,0.7519,0.7729,0.745,0.7796,0.7015,0.7228,0.7677,0.764,0.7462,0.7738,0.7661,0.7446,0.7167,0.706,0.7062,0.6931,0.7327,0.6986,0.6904,0.6576,0.7005,0.6601,0.6016,0.656,0.5931,0.6261,0.6518,0.6266,0.6004,0.607,0.5686,0.6271,0.5872000000000001,0.5691000000000001,0.5803,0.5638,0.5569,0.5939,0.5502,0.5256,0.5376,0.5686,0.5436,0.5336,0.5323,0.5231,0.5083,0.5087,0.5125,0.5066000000000001,0.5144,0.5042,0.5046,0.5042,0.5021,0.5044,0.5087],[0.9917,0.9625,0.9583,0.9542,0.95,0.9458,0.9417,0.9375,0.9375,0.9333,0.9333,0.925,0.9208,0.9208,0.9208,0.9208,0.9125,0.9083,0.9083,0.9042,0.9,0.9,0.9,0.9,0.8958,0.8875,0.8875,0.8875,0.8875,0.8875,0.8833,0.8833,0.8792,0.8708,0.8708,0.8667,0.8625,0.8583,0.8417,0.8417,0.825,0.825,0.8208,0.8208,0.8167,0.8125,0.8083,0.7958,0.7917,0.7875,0.7875,0.7833,0.7833,0.775,0.775,0.7625,0.7542,0.75,0.7458,0.7292,0.725,0.725,0.7083,0.6958,0.6833,0.675,0.6708,0.6667,0.6625,0.6542,0.65,0.6417,0.6042,0.6,0.5958,0.5542,0.5083,0.5042],[1,1,0.9958,1,0.9875,1,1,1,1,0.9893,0.9955000000000001,1,1,0.9935,0.996,1,0.9938,0.9855,0.9915,0.998,0.9958,1,0.9911,0.9937,0.9913,0.9833,0.9827,0.9769,0.9919,0.9748,1,0.9959,0.9718,0.9777,0.9604,0.9772,0.9772,0.9564,0.9467,0.9853,0.95,0.9707,0.9627,0.9503,0.9619,0.9495,0.9441000000000001,0.9397,0.9413,0.9283,0.8963,0.9347,0.9131,0.9191,0.9103,0.9048,0.9235,0.8856000000000001,0.9494,0.8794999999999999,0.8893,0.8985,0.8687,0.8742,0.8831,0.8525,0.8863,0.8771,0.8225,0.8529,0.8227,0.8053,0.785,0.7825,0.7957,0.7543,0.7498,0.7247]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Signature<\/th>\n      <th>P.value<\/th>\n      <th>neg10xLog.P.value.<\/th>\n      <th>LowerAUC<\/th>\n      <th>AUC<\/th>\n      <th>UpperAUC<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="boxplots-for-the-bootstrapped-aucs">Boxplots for the bootstrapped AUCs<a class="anchor" aria-label="anchor" href="#boxplots-for-the-bootstrapped-aucs"></a>
</h4>
<p>We can visualize the bootstrapped AUCs for the scored signatures by
creating a collection of boxplots.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/compareBoxplots.html">compareBoxplots</a></span><span class="op">(</span><span class="va">ssgsea_result</span>, annotationColName <span class="op">=</span> <span class="st">"Disease"</span>,</span>
<span>                signatureColNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TBsignatures</span><span class="op">)</span>,</span>
<span>                pb.show <span class="op">=</span> <span class="cn">FALSE</span>, rotateLabels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="TBSig_Vignette_files/figure-html/BS_Boxplots-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="roc-plots-for-all-signatures-with-95-ci-bands">ROC plots for all signatures with 95% CI bands<a class="anchor" aria-label="anchor" href="#roc-plots-for-all-signatures-with-95-ci-bands"></a>
</h4>
<p>The <code>signatureROCplot_CI</code> function plots the ROC curves
for signature scores in separate plots, along with CI bands for the
specified level of confidence. The <code>signatureROCplot</code>
function is similar, but does not include confidence interval bands.</p>
<p>Note that, in some cases, signatures will be positive identifiers of
TB whereas others are negative identifiers, hence some ROC curves will
be below the chance line.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/signatureROCplot_CI.html">signatureROCplot_CI</a></span><span class="op">(</span>inputData <span class="op">=</span> <span class="va">ssgsea_result</span>,</span>
<span>                   signatureColNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TBsignatures</span><span class="op">)</span>,</span>
<span>                   annotationColName <span class="op">=</span> <span class="st">"Disease"</span>, pb.show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="TBSig_Vignette_files/figure-html/ROC_all-1.png" width="1152"></p>
</div>
<div class="section level4">
<h4 class="tabset" id="separate-roc-plots-95-ci-bands">Separate ROC plots, 95% CI bands<a class="anchor" aria-label="anchor" href="#separate-roc-plots-95-ci-bands"></a>
</h4>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">sigs</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"####"</span>, <span class="va">i</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../../reference/signatureROCplot_CI.html">signatureROCplot_CI</a></span><span class="op">(</span>inputData <span class="op">=</span> <span class="va">ssgsea_result</span>,</span>
<span>                   signatureColNames <span class="op">=</span> <span class="va">i</span>,</span>
<span>                   annotationColName <span class="op">=</span> <span class="st">"Disease"</span>,</span>
<span>                   name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"ROC plot,"</span>, <span class="va">i</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>, pb.show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level5">
<h5 id="anderson_42-2">Anderson_42<a class="anchor" aria-label="anchor" href="#anderson_42-2"></a>
</h5>
<p><img src="TBSig_Vignette_files/figure-html/ROC_indiv-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="anderson_od_51-2">Anderson_OD_51<a class="anchor" aria-label="anchor" href="#anderson_od_51-2"></a>
</h5>
<p><img src="TBSig_Vignette_files/figure-html/ROC_indiv-2.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="zak_risk_16-2">Zak_RISK_16<a class="anchor" aria-label="anchor" href="#zak_risk_16-2"></a>
</h5>
<p><img src="TBSig_Vignette_files/figure-html/ROC_indiv-3.png" width="700"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 class="tabset" id="signature-evaluation-with-logistic-regression">Signature Evaluation with Logistic Regression<a class="anchor" aria-label="anchor" href="#signature-evaluation-with-logistic-regression"></a>
</h3>
<p>Another method of signature evaluation featured in the
TBSignatureProfiler package is available with the
<code>SignatureQuantitative</code> function.</p>
<p>During the training process, we bootstrap the samples, cross-validate
the logistic regression prediction of the TB HIV status of each sample,
and calculate the validation set AUCs from each cross-validation
iteration. In theory, if a signature is a useful predictor of status, it
should have a higher average AUC from these logistic regression
bootstraps.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Make an additional binary indicator for signature evaluation</span></span>
<span><span class="va">hivtb_data</span><span class="op">$</span><span class="va">BinaryTB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">hivtb_data</span><span class="op">$</span><span class="va">Disease</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co">## We can normalize the data and evaluate the signatures</span></span>
<span><span class="va">hivtb_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/deseq2_norm_rle.html">deseq2_norm_rle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">hivtb_data</span>, <span class="st">"counts"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">quantitative.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/SignatureQuantitative.html">SignatureQuantitative</a></span><span class="op">(</span><span class="va">hivtb_norm</span>,</span>
<span>                       targetVec.num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">hivtb_data</span><span class="op">)</span><span class="op">$</span><span class="va">BinaryTB</span>,</span>
<span>                       signature.list <span class="op">=</span> <span class="va">TBsignatures</span><span class="op">[</span><span class="va">sigs</span><span class="op">]</span>,</span>
<span>                       signature.name.vec <span class="op">=</span> <span class="va">sigs</span>,</span>
<span>                       num.boot <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                       pb.show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We also create a boxplot of AUC for each signature, which provides a
clear comparison between the signatures.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/plotQuantitative.html">plotQuantitative</a></span><span class="op">(</span><span class="va">hivtb_norm</span>, targetVec.num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">hivtb_data</span><span class="op">)</span><span class="op">$</span><span class="va">BinaryTB</span>,</span>
<span>                       signature.list <span class="op">=</span> <span class="va">TBsignatures</span><span class="op">[</span><span class="va">sigs</span><span class="op">]</span>,</span>
<span>                       signature.name.vec <span class="op">=</span> <span class="va">sigs</span>,</span>
<span>                       num.boot <span class="op">=</span> <span class="fl">3</span>, pb.show <span class="op">=</span> <span class="cn">FALSE</span>, rotateLabels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="TBSig_Vignette_files/figure-html/sigeval_plot-1.png" width="700"></p>
<div class="section level4">
<h4 id="table-of-auc-results">Table of AUC Results<a class="anchor" aria-label="anchor" href="#table-of-auc-results"></a>
</h4>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">quantitative.result</span><span class="op">$</span><span class="va">df.auc.ci</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>              options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scrollX <span class="op">=</span> <span class="cn">TRUE</span>, pageLength <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>              rownames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-2e2e282b3358d9bab19b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2e2e282b3358d9bab19b">{"x":{"filter":"none","vertical":false,"data":[[0.7625,0.8458,0.9042],[0.9671999999999999,0.9318,0.8737],[0.9975000000000001,0.9634,0.9885],[-0,0,-0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Estimate<\/th>\n      <th>CI lower.5%<\/th>\n      <th>CI upper.95%<\/th>\n      <th>Std. Error<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="table-of-sensitivity-results">Table of Sensitivity Results<a class="anchor" aria-label="anchor" href="#table-of-sensitivity-results"></a>
</h4>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">quantitative.result</span><span class="op">$</span><span class="va">df.sensitivity.ci</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>              options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scrollX <span class="op">=</span> <span class="cn">TRUE</span>, pageLength <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>              rownames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-6d9c091cdd8995b14cb4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6d9c091cdd8995b14cb4">{"x":{"filter":"none","vertical":false,"data":[[0.625,0.875,0.875],[0.9357,0.8937,0.955],[1,0.9375,1],[0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Estimate.Sensitivity<\/th>\n      <th>CI lower.5%<\/th>\n      <th>CI upper.95%<\/th>\n      <th>Std. Error<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="table-of-specificity-results">Table of Specificity Results<a class="anchor" aria-label="anchor" href="#table-of-specificity-results"></a>
</h4>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">quantitative.result</span><span class="op">$</span><span class="va">df.specificity.ci</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>              options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scrollX <span class="op">=</span> <span class="cn">TRUE</span>, pageLength <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>              rownames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-6cea1bd389c2e4d48a6c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6cea1bd389c2e4d48a6c">{"x":{"filter":"none","vertical":false,"data":[[0.8,0.8,0.8667],[0.9357,0.8046,0.7469],[1,0.9246,0.928],[0,-0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Estimate.Specificity<\/th>\n      <th>CI lower.5%<\/th>\n      <th>CI upper.95%<\/th>\n      <th>Std. Error<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[0,1,2,3]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: AlmaLinux 8.9 (Midnight Oncilla)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /share/pkg.8/r/4.3.1/install/lib64/R/lib/libRblas.so </span></span>
<span><span class="co">## LAPACK: /share/pkg.8/r/4.3.1/install/lib64/R/lib/libRlapack.so;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: America/New_York</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] TBSignatureProfiler_1.15.0  SummarizedExperiment_1.32.0</span></span>
<span><span class="co">##  [3] Biobase_2.62.0              GenomicRanges_1.54.1       </span></span>
<span><span class="co">##  [5] GenomeInfoDb_1.38.5         IRanges_2.36.0             </span></span>
<span><span class="co">##  [7] S4Vectors_0.40.2            BiocGenerics_0.48.1        </span></span>
<span><span class="co">##  [9] MatrixGenerics_1.14.0       matrixStats_1.2.0          </span></span>
<span><span class="co">## [11] BiocStyle_2.28.0           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] splines_4.3.1               bitops_1.0-7               </span></span>
<span><span class="co">##   [3] tibble_3.2.1                hardhat_1.3.0              </span></span>
<span><span class="co">##   [5] graph_1.78.0                pROC_1.18.2                </span></span>
<span><span class="co">##   [7] XML_3.99-0.16.1             rpart_4.1.19               </span></span>
<span><span class="co">##   [9] lifecycle_1.0.4             edgeR_3.42.4               </span></span>
<span><span class="co">##  [11] doParallel_1.0.17           globals_0.16.2             </span></span>
<span><span class="co">##  [13] lattice_0.21-8              MASS_7.3-60                </span></span>
<span><span class="co">##  [15] crosstalk_1.2.0             magrittr_2.0.3             </span></span>
<span><span class="co">##  [17] limma_3.56.2                sass_0.4.8                 </span></span>
<span><span class="co">##  [19] rmarkdown_2.25              jquerylib_0.1.4            </span></span>
<span><span class="co">##  [21] yaml_2.3.8                  ROCit_2.1.1                </span></span>
<span><span class="co">##  [23] HGNChelper_0.8.1            DBI_1.2.1                  </span></span>
<span><span class="co">##  [25] RColorBrewer_1.1-3          lubridate_1.9.3            </span></span>
<span><span class="co">##  [27] abind_1.4-5                 zlibbioc_1.48.0            </span></span>
<span><span class="co">##  [29] purrr_1.0.2                 RCurl_1.98-1.14            </span></span>
<span><span class="co">##  [31] nnet_7.3-19                 ipred_0.9-14               </span></span>
<span><span class="co">##  [33] circlize_0.4.15             lava_1.7.2.1               </span></span>
<span><span class="co">##  [35] GenomeInfoDbData_1.2.11     irlba_2.3.5.1              </span></span>
<span><span class="co">##  [37] listenv_0.9.0               gdata_2.19.0               </span></span>
<span><span class="co">##  [39] GSVA_1.51.5                 annotate_1.78.0            </span></span>
<span><span class="co">##  [41] parallelly_1.36.0           pkgdown_2.0.7              </span></span>
<span><span class="co">##  [43] DelayedMatrixStats_1.22.1   codetools_0.2-19           </span></span>
<span><span class="co">##  [45] DelayedArray_0.28.0         DT_0.28                    </span></span>
<span><span class="co">##  [47] tidyselect_1.2.0            shape_1.4.6                </span></span>
<span><span class="co">##  [49] farver_2.1.1                ScaledMatrix_1.8.1         </span></span>
<span><span class="co">##  [51] jsonlite_1.8.8              caret_6.0-94               </span></span>
<span><span class="co">##  [53] GetoptLong_1.0.5            e1071_1.7-14               </span></span>
<span><span class="co">##  [55] ellipsis_0.3.2              survival_3.5-5             </span></span>
<span><span class="co">##  [57] iterators_1.0.14            systemfonts_1.0.4          </span></span>
<span><span class="co">##  [59] foreach_1.5.2               tools_4.3.1                </span></span>
<span><span class="co">##  [61] ragg_1.2.5                  Rcpp_1.0.12                </span></span>
<span><span class="co">##  [63] glue_1.7.0                  prodlim_2023.03.31         </span></span>
<span><span class="co">##  [65] SparseArray_1.2.3           xfun_0.41                  </span></span>
<span><span class="co">##  [67] DESeq2_1.40.1               dplyr_1.1.4                </span></span>
<span><span class="co">##  [69] HDF5Array_1.28.1            withr_3.0.0                </span></span>
<span><span class="co">##  [71] BiocManager_1.30.22         fastmap_1.1.1              </span></span>
<span><span class="co">##  [73] rhdf5filters_1.12.1         fansi_1.0.6                </span></span>
<span><span class="co">##  [75] digest_0.6.34               rsvd_1.0.5                 </span></span>
<span><span class="co">##  [77] timechange_0.2.0            R6_2.5.1                   </span></span>
<span><span class="co">##  [79] textshaping_0.3.6           colorspace_2.1-0           </span></span>
<span><span class="co">##  [81] Cairo_1.6-2                 gtools_3.9.5               </span></span>
<span><span class="co">##  [83] RSQLite_2.3.5               utf8_1.2.4                 </span></span>
<span><span class="co">##  [85] tidyr_1.3.1                 generics_0.1.3             </span></span>
<span><span class="co">##  [87] data.table_1.14.10          recipes_1.0.6              </span></span>
<span><span class="co">##  [89] class_7.3-22                httr_1.4.7                 </span></span>
<span><span class="co">##  [91] htmlwidgets_1.6.4           S4Arrays_1.2.0             </span></span>
<span><span class="co">##  [93] ModelMetrics_1.2.2.2        pkgconfig_2.0.3            </span></span>
<span><span class="co">##  [95] gtable_0.3.4                timeDate_4032.109          </span></span>
<span><span class="co">##  [97] blob_1.2.4                  ComplexHeatmap_2.16.0      </span></span>
<span><span class="co">##  [99] SingleCellExperiment_1.22.0 XVector_0.42.0             </span></span>
<span><span class="co">## [101] htmltools_0.5.7             bookdown_0.34              </span></span>
<span><span class="co">## [103] GSEABase_1.62.0             clue_0.3-65                </span></span>
<span><span class="co">## [105] scales_1.3.0                png_0.1-8                  </span></span>
<span><span class="co">## [107] gower_1.0.1                 knitr_1.45                 </span></span>
<span><span class="co">## [109] rstudioapi_0.15.0           reshape2_1.4.4             </span></span>
<span><span class="co">## [111] rjson_0.2.21                nlme_3.1-162               </span></span>
<span><span class="co">## [113] proxy_0.4-27                cachem_1.0.8               </span></span>
<span><span class="co">## [115] rhdf5_2.44.0                GlobalOptions_0.1.2        </span></span>
<span><span class="co">## [117] stringr_1.5.1               parallel_4.3.1             </span></span>
<span><span class="co">## [119] AnnotationDbi_1.62.1        desc_1.4.3                 </span></span>
<span><span class="co">## [121] pillar_1.9.0                grid_4.3.1                 </span></span>
<span><span class="co">## [123] vctrs_0.6.5                 BiocSingular_1.16.0        </span></span>
<span><span class="co">## [125] beachmat_2.16.0             xtable_1.8-4               </span></span>
<span><span class="co">## [127] cluster_2.1.4               evaluate_0.23              </span></span>
<span><span class="co">## [129] singscore_1.20.0            magick_2.7.4               </span></span>
<span><span class="co">## [131] cli_3.6.2                   locfit_1.5-9.8             </span></span>
<span><span class="co">## [133] compiler_4.3.1              rlang_1.1.3                </span></span>
<span><span class="co">## [135] crayon_1.5.2                future.apply_1.11.0        </span></span>
<span><span class="co">## [137] labeling_0.4.3              plyr_1.8.9                 </span></span>
<span><span class="co">## [139] fs_1.6.3                    stringi_1.8.3              </span></span>
<span><span class="co">## [141] BiocParallel_1.36.0         munsell_0.5.0              </span></span>
<span><span class="co">## [143] Biostrings_2.70.1           glmnet_4.1-7               </span></span>
<span><span class="co">## [145] Matrix_1.6-5                sparseMatrixStats_1.12.1   </span></span>
<span><span class="co">## [147] bit64_4.0.5                 future_1.32.0              </span></span>
<span><span class="co">## [149] ggplot2_3.4.4               Rhdf5lib_1.22.1            </span></span>
<span><span class="co">## [151] KEGGREST_1.40.0             highr_0.10                 </span></span>
<span><span class="co">## [153] memoise_2.0.1               bslib_0.6.1                </span></span>
<span><span class="co">## [155] bit_4.0.5</span></span></code></pre>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Site created by Aubrey R. Odom.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
