<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function takes the profiled gene expression data for a single signature
and creates a heatmap based on the expression scores."><title>Plot a heatmap of a single signature score with individual gene expression levels. — signatureGeneHeatmap • TBSignatureProfiler</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a heatmap of a single signature score with individual gene expression levels. — signatureGeneHeatmap"><meta property="og:description" content="This function takes the profiled gene expression data for a single signature
and creates a heatmap based on the expression scores."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TBSignatureProfiler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.90.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/rmd/TBSig_Vignette.html">Command Line Analysis</a>
    <a class="dropdown-item" href="../articles/rmd/OriginalModelTutorial.html">Original Models</a>
    <a class="dropdown-item" href="../articles/rmd/shinytutorial.html">Interactive Shiny Analysis</a>
    <a class="dropdown-item" href="../articles/rmd/SignatureAddition.html">Adding Signatures to the Profiler</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Function Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">TBSP News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/compbiomed/TBSignatureProfiler">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot a heatmap of a single signature score with individual gene expression levels.</h1>
      <small class="dont-index">Source: <a href="https://github.com/compbiomed/TBSignatureProfiler/blob/HEAD/R/plot.R" class="external-link"><code>R/plot.R</code></a></small>
      <div class="d-none name"><code>signatureGeneHeatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes the profiled gene expression data for a single signature
and creates a heatmap based on the expression scores.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">signatureGeneHeatmap</span><span class="op">(</span>
  <span class="va">inputData</span>,
  <span class="va">useAssay</span>,
  <span class="va">sigGenes</span>,
  name <span class="op">=</span> <span class="st">"Signature"</span>,
  signatureColNames <span class="op">=</span> <span class="cn">NULL</span>,
  annotationColNames <span class="op">=</span> <span class="cn">NULL</span>,
  scale <span class="op">=</span> <span class="cn">TRUE</span>,
  showColumnNames <span class="op">=</span> <span class="cn">TRUE</span>,
  showRowNames <span class="op">=</span> <span class="cn">TRUE</span>,
  colList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  colorSets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Set1"</span>, <span class="st">"Set2"</span>, <span class="st">"Set3"</span>, <span class="st">"Pastel1"</span>, <span class="st">"Pastel2"</span>, <span class="st">"Accent"</span>, <span class="st">"Dark2"</span>,
    <span class="st">"Paired"</span><span class="op">)</span>,
  choose_color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"gray95"</span>, <span class="st">"red"</span><span class="op">)</span>,
  column_order <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>inputData</dt>
<dd><p>a <code>SummarizedExperiment</code> object containing the profiled
signature data and annotation data as columns in the <code>colData</code>.
Required.</p></dd>
<dt>useAssay</dt>
<dd><p>a character string specifying the assay to use for the gene
expression data. Required.</p></dd>
<dt>sigGenes</dt>
<dd><p>a vector identifying the genes in the signature to use in
the heatmap. For inbuilt signatures, you can use <code>TBsignatures</code>
(e.g., <code>TBsignatures[["ACS_COR"]]</code>). Required.</p></dd>
<dt>name</dt>
<dd><p>a character string with the plot title of the heatmap. The
default is <code>"Signatures"</code>.</p></dd>
<dt>signatureColNames</dt>
<dd><p>a vector of the column names in the <code>colData</code>
that contain the signature data. Required.</p></dd>
<dt>annotationColNames</dt>
<dd><p>a vector of the column names in the <code>colData</code>
that contain the annotation data. If <code>NULL</code>, no annotation bar besides
those of the scoring algorithms will be drawn on the heatmap. The default
is <code>NULL</code>.</p></dd>
<dt>scale</dt>
<dd><p>logical. Setting <code>scale = TRUE</code> scales the signature data.
The default is <code>TRUE</code>.</p></dd>
<dt>showColumnNames</dt>
<dd><p>logical. Setting <code>showColumnNames = TRUE</code> will
show the column names (i.e. sample names) on the heatmap. The default is
<code>TRUE</code>.</p></dd>
<dt>showRowNames</dt>
<dd><p>logical. Setting <code>showColumnNames = TRUE</code> will
show the row names (i.e. signature names) on the heatmap. The default is
<code>TRUE</code>.</p></dd>
<dt>colList</dt>
<dd><p>a named <code>list</code> of named vectors specifying custom color
information to pass to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>.
The list should have as many elements as there are annotation columns
and gene signatures (i.e. <code>sigGenes</code>), and each element name should
correspond exactly with the name of each annotation column/signature.
The colors in the vector elements should be named according to the
levels of the factor in that column's annotation data if the annotation
is discrete, or it should be produced with <code><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">circlize::colorRamp2</a></code>
if the annotation/gene is continuous.
By default, <code>ColorBrewer</code> color sets will be used.
See the the parameter <code>colorSets</code> for additional details.</p></dd>
<dt>colorSets</dt>
<dd><p>a vector of names listing the color sets in the order
that they should be used in creating the heatmap. By default, this function
will use the color sets in the order listed in <code>Usage</code> for annotation
information. You may replace the default with the same collection of sets
in order that you want to use them, or provide custom color sets with the
<code>colList</code> parameter.</p></dd>
<dt>choose_color</dt>
<dd><p>a vector of color names to be interpolated for the
heatmap gradient, or a <code>colorRamp</code> function produced by
<code><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">circlize::colorRamp2</a></code>. The default is <code>c("blue", "gray95", "red")</code>.</p></dd>
<dt>column_order</dt>
<dd><p>a vector of character strings indicating the order in
which to manually arrange the heatmap columns. Default is <code>NULL</code>,
such that column order is automatically determined via clustering.</p></dd>
<dt>...</dt>
<dd><p>Additional arguments to be passed to
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ComplexHeatmap</code> plot.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Generate some artificial data that shows a difference in Zak_RISK_16</span></span>
<span class="r-in"><span class="va">mat_testdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">80</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">80</span><span class="op">)</span> <span class="op">+</span> <span class="fl">5</span><span class="op">)</span>, <span class="fl">16</span>, <span class="fl">10</span>,</span>
<span class="r-in">                             dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">TBsignatures</span><span class="op">$</span><span class="va">Zak_RISK_16</span>,</span>
<span class="r-in">                                             <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sample"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">                      <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>, <span class="fl">100</span>, <span class="fl">10</span>,</span>
<span class="r-in">                             dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gene"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">                                             <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sample"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Create a SummarizedExperiment object that contains the data</span></span>
<span class="r-in"><span class="va">testdataSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></span><span class="op">(</span>assays <span class="op">=</span> <span class="fu">SimpleList</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mat_testdata</span><span class="op">)</span>,</span>
<span class="r-in">                                   colData <span class="op">=</span> <span class="fu">DataFrame</span><span class="op">(</span>sample <span class="op">=</span></span>
<span class="r-in">                                                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"down"</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span class="r-in">                                                         <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"up"</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Run profiler using GSVA and ssGSEA on Zak_RISK_16</span></span>
<span class="r-in"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="runTBsigProfiler.html">runTBsigProfiler</a></span><span class="op">(</span><span class="va">testdataSE</span>, useAssay <span class="op">=</span> <span class="st">"data"</span>,</span>
<span class="r-in">                        signatures <span class="op">=</span> <span class="va">TBsignatures</span><span class="op">[</span><span class="st">"Zak_RISK_16"</span><span class="op">]</span>,</span>
<span class="r-in">                        algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GSVA"</span>, <span class="st">"ssGSEA"</span><span class="op">)</span>, parallel.sz <span class="op">=</span> <span class="fl">1</span>,</span>
<span class="r-in">                        combineSigAndAlgorithm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Parameter update_genes is TRUE. Gene names will be updated.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running GSVA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating GSVA scores for 1 gene sets.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating ECDFs with Gaussian kernels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running ssGSEA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimating ssGSEA scores for 1 gene sets.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot a heatmap of signature genes and pathway predictions</span></span>
<span class="r-in"><span class="fu">signatureGeneHeatmap</span><span class="op">(</span><span class="va">res</span>, useAssay <span class="op">=</span> <span class="st">"data"</span>,</span>
<span class="r-in">                     sigGenes <span class="op">=</span> <span class="va">TBsignatures</span><span class="op">[[</span><span class="st">"Zak_RISK_16"</span><span class="op">]</span><span class="op">]</span>,</span>
<span class="r-in">                     signatureColNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GSVA_Zak_RISK_16"</span>,</span>
<span class="r-in">                                           <span class="st">"ssGSEA_Zak_RISK_16"</span><span class="op">)</span>,</span>
<span class="r-in">                     annotationColNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample"</span><span class="op">)</span>, showColumnNames <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span class="r-in">                     name <span class="op">=</span> <span class="st">"Zak_RISK_16"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="signatureGeneHeatmap-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Site created by Aubrey R. Odom-Mabey.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

