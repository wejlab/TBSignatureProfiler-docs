<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot a heatmap of a single signature score with individual gene expression levels. — signatureGeneHeatmap • TBSignatureProfiler</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot a heatmap of a single signature score with individual gene expression levels. — signatureGeneHeatmap" />
<meta property="og:description" content="This function takes the profiled gene expression data for a single signature
and creates a heatmap based on the expression scores." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TBSignatureProfiler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/TBSig_Vignette.html">Introduction to the TBSignatureProfiler</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/compbiomed/TBSignatureProfiler/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a heatmap of a single signature score with individual gene expression levels.</h1>
    <small class="dont-index">Source: <a href='https://github.com/compbiomed/TBSignatureProfiler/blob/master/R/plot.R'><code>R/plot.R</code></a></small>
    <div class="hidden name"><code>signatureGeneHeatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function takes the profiled gene expression data for a single signature
and creates a heatmap based on the expression scores.</p>
    </div>

    <pre class="usage"><span class='fu'>signatureGeneHeatmap</span>(
  <span class='no'>inputData</span>,
  <span class='no'>useAssay</span>,
  <span class='no'>sigGenes</span>,
  <span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"Signature"</span>,
  <span class='kw'>signatureColNames</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>annotationColNames</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>showColumnNames</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>showRowNames</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>colList</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>colorSets</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Set1"</span>, <span class='st'>"Set2"</span>, <span class='st'>"Set3"</span>, <span class='st'>"Pastel1"</span>, <span class='st'>"Pastel2"</span>, <span class='st'>"Accent"</span>, <span class='st'>"Dark2"</span>,
    <span class='st'>"Paired"</span>),
  <span class='kw'>choose_color</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"blue"</span>, <span class='st'>"gray95"</span>, <span class='st'>"red"</span>),
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>inputData</th>
      <td><p>a <code>SummarizedExperiment</code> object containing the profiled
signature data and annotation data as columns in the <code>colData</code>.
Required.</p></td>
    </tr>
    <tr>
      <th>useAssay</th>
      <td><p>a character string specifying the assay to use for the gene
expression data. Required.</p></td>
    </tr>
    <tr>
      <th>sigGenes</th>
      <td><p>a vector identifying the genes in the signature to use in
the heatmap. For inbuilt signatures, you can use <code>TBsignatures</code>
(e.g., <code>TBsignatures[["ACS_COR"]]</code>). Required.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>a character string with the plot title of the heatmap. The
default is <code>"Signatures"</code>.</p></td>
    </tr>
    <tr>
      <th>signatureColNames</th>
      <td><p>a vector of the column names in the <code>colData</code>
that contain the signature data. Required.</p></td>
    </tr>
    <tr>
      <th>annotationColNames</th>
      <td><p>a vector of the column names in the <code>colData</code>
that contain the annotation data. If <code>NULL</code>, no annotation bar besides
those of the scoring algorithms will be drawn on the heatmap. The default
is <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>logical. Setting <code>scale = TRUE</code> scales the signature data.
The default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>showColumnNames</th>
      <td><p>logical. Setting <code>showColumnNames = TRUE</code> will
show the column names (i.e. sample names) on the heatmap. The default is
<code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>showRowNames</th>
      <td><p>logical. Setting <code>showColumnNames = TRUE</code> will
show the row names (i.e. signature names) on the heatmap. The default is
<code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>colList</th>
      <td><p>a named <code>list</code> of named vectors specifying custom color
information to pass to <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>ComplexHeatmap::Heatmap()</a></code>.
The list should have as many elements as there are annotation columns
and gene signatures (i.e. <code>sigGenes</code>), and each element name should
correspond exactly with the name of each annotation column/signature.
The colors in the vector elements should be named according to the
levels of the factor in that column's annotation data if the annotation
is discrete, or it should be produced with <code><a href='https://rdrr.io/pkg/circlize/man/colorRamp2.html'>circlize::colorRamp2</a></code>
if the annotation/gene is continuous.
By default, <code>ColorBrewer</code> color sets will be used.
See the the parameter <code>colorSets</code> for additional details.</p></td>
    </tr>
    <tr>
      <th>colorSets</th>
      <td><p>a vector of names listing the color sets in the order
that they should be used in creating the heatmap. By default, this function
will use the color sets in the order listed in <code>Usage</code> for annotation
information. You may replace the default with the same collection of sets
in order that you want to use them, or provide custom color sets with the
<code>colList</code> parameter.</p></td>
    </tr>
    <tr>
      <th>choose_color</th>
      <td><p>a vector of color names to be interpolated for the
heatmap gradient, or a <code>colorRamp</code> function produced by
<code><a href='https://rdrr.io/pkg/circlize/man/colorRamp2.html'>circlize::colorRamp2</a></code>. The default is <code><a href='https://rdrr.io/r/base/c.html'>c("blue", "gray95", "red")</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters to pass to <code><a href='https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html'>ComplexHeatmap::Heatmap()</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>ComplexHeatmap</code> plot.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>SummarizedExperiment</span>)
<span class='co'># Generate some artificial data that shows a difference in Zak_RISK_16</span>
<span class='no'>mat_testdata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>80</span>), <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>80</span>) + <span class='fl'>5</span>), <span class='fl'>16</span>, <span class='fl'>10</span>,
                             <span class='kw'>dimnames</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='no'>TBsignatures</span>$<span class='no'>Zak_RISK_16</span>,
                                             <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"sample"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span>(<span class='fl'>10</span>)))),
                      <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>1000</span>), <span class='fl'>100</span>, <span class='fl'>10</span>,
                             <span class='kw'>dimnames</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"gene"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span>(<span class='fl'>100</span>)),
                                             <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span>(<span class='st'>"sample"</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span>(<span class='fl'>10</span>)))))

<span class='co'># Create a SummarizedExperiment object that contains the data</span>
<span class='no'>testdataSE</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html'>SummarizedExperiment</a></span>(<span class='kw'>assays</span> <span class='kw'>=</span> <span class='fu'>SimpleList</span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>mat_testdata</span>),
                                   <span class='kw'>colData</span> <span class='kw'>=</span> <span class='fu'>DataFrame</span>(<span class='kw'>sample</span> <span class='kw'>=</span>
                                                       <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"down"</span>, <span class='fl'>5</span>),
                                                         <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"up"</span>, <span class='fl'>5</span>))))
<span class='co'># Run profiler using GSVA and ssGSEA on Zak_RISK_16</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='runTBsigProfiler.html'>runTBsigProfiler</a></span>(<span class='no'>testdataSE</span>, <span class='kw'>useAssay</span> <span class='kw'>=</span> <span class='st'>"data"</span>,
                        <span class='kw'>signatures</span> <span class='kw'>=</span> <span class='no'>TBsignatures</span>[<span class='st'>"Zak_RISK_16"</span>],
                        <span class='kw'>algorithm</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"GSVA"</span>, <span class='st'>"ssGSEA"</span>), <span class='kw'>parallel.sz</span> <span class='kw'>=</span> <span class='fl'>1</span>,
                        <span class='kw'>combineSigAndAlgorithm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='message'>Running GSVA</span></div><div class='output co'>#&gt; Estimating GSVA scores for 1 gene sets.
#&gt; Computing observed enrichment scores
#&gt; Estimating ECDFs with Gaussian kernels
#&gt; Using parallel with 1 cores
#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</div><div class='output co'>#&gt; <span class='message'>Running ssGSEA</span></div><div class='output co'>#&gt; Estimating ssGSEA scores for 1 gene sets.
#&gt;   |                                                                              |                                                                      |   0%Using parallel with 1 cores
#&gt;   |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># Plot a heatmap of signature genes and pathway predictions</span>
<span class='fu'>signatureGeneHeatmap</span>(<span class='no'>res</span>, <span class='kw'>useAssay</span> <span class='kw'>=</span> <span class='st'>"data"</span>,
                     <span class='kw'>sigGenes</span> <span class='kw'>=</span> <span class='no'>TBsignatures</span><span class='kw'>[[</span><span class='st'>"Zak_RISK_16"</span>]],
                     <span class='kw'>signatureColNames</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"GSVA_Zak_RISK_16"</span>,
                                           <span class='st'>"ssGSEA_Zak_RISK_16"</span>),
                     <span class='kw'>annotationColNames</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"sample"</span>), <span class='kw'>showColumnNames</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                     <span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"Zak_RISK_16"</span>)</div><div class='img'><img src='signatureGeneHeatmap-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Jenkins, Yue Zhao, W. Evan Johnson, Aubrey Odom, Christian Love.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


