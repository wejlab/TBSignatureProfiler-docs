<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="It may be useful to compare the results of scoring across several different
scoring algorithms via a method of visualization, such as a heatmap. The
compareSigs function allows the input of a SummarizedExperiment
data object and conducts
profiling on each signature desired, and outputting a heatmap or boxplot
for each signature."><title>Compare scoring algorithms on a single signature via heatmap or boxplot. — compareAlgs • TBSignatureProfiler</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare scoring algorithms on a single signature via heatmap or boxplot. — compareAlgs"><meta property="og:description" content="It may be useful to compare the results of scoring across several different
scoring algorithms via a method of visualization, such as a heatmap. The
compareSigs function allows the input of a SummarizedExperiment
data object and conducts
profiling on each signature desired, and outputting a heatmap or boxplot
for each signature."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TBSignatureProfiler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.13.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/rmd/TBSig_Vignette.html">Command Line Analysis</a>
    <a class="dropdown-item" href="../articles/rmd/OriginalModelTutorial.html">Original Models</a>
    <a class="dropdown-item" href="../articles/rmd/shinytutorial.html">Interactive Shiny Analysis</a>
    <a class="dropdown-item" href="../articles/rmd/SignatureAddition.html">Adding Signatures to the Profiler</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Function Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">TBSP News</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/wejlab/TBSignatureProfiler">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compare scoring algorithms on a single signature via heatmap or boxplot.</h1>
      <small class="dont-index">Source: <a href="https://github.com/compbiomed/TBSignatureProfiler/blob/HEAD/R/profile.R" class="external-link"><code>R/profile.R</code></a></small>
      <div class="d-none name"><code>compareAlgs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>It may be useful to compare the results of scoring across several different
scoring algorithms via a method of visualization, such as a heatmap. The
<code>compareSigs</code> function allows the input of a SummarizedExperiment
data object and conducts
profiling on each signature desired, and outputting a heatmap or boxplot
for each signature.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compareAlgs</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  signatures <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">annotationColName</span>,</span>
<span>  useAssay <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GSVA"</span>, <span class="st">"ssGSEA"</span>, <span class="st">"ASSIGN"</span>, <span class="st">"PLAGE"</span>, <span class="st">"Zscore"</span>, <span class="st">"singscore"</span><span class="op">)</span>,</span>
<span>  showColumnNames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showRowNames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  colorSets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Set1"</span>, <span class="st">"Set2"</span>, <span class="st">"Set3"</span>, <span class="st">"Pastel1"</span>, <span class="st">"Pastel2"</span>, <span class="st">"Accent"</span>, <span class="st">"Dark2"</span>,</span>
<span>    <span class="st">"Paired"</span><span class="op">)</span>,</span>
<span>  choose_color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"gray95"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>  colList <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  show.pb <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  parallel.sz <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  output <span class="op">=</span> <span class="st">"heatmap"</span>,</span>
<span>  num.boot <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  column_order <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>input</dt>
<dd><p>an input data object of the class <code>"SummarizedExperiment"</code>.
Required.</p></dd>


<dt>signatures</dt>
<dd><p>a <code>list</code> of signatures to run with their associated genes.
This list should be in the same format as <code>TBsignatures</code>, included in
the TBSignatureProfiler package. If <code>signatures = NULL</code>, the default set
of signatures <code>TBsignatures</code> list is used.
For details, run <code><a href="TBsignatures.html">?TBsignatures</a></code>.
If &lt;2 genes in a signature are present in the sample, that signature will
not be evaluated and will not be present in the resulting SE object.
The default is <code>NULL</code>.</p></dd>


<dt>annotationColName</dt>
<dd><p>a character string giving the column name in
<code>colData</code> that contains the annotation data. Required.</p></dd>


<dt>useAssay</dt>
<dd><p>a character string specifying the assay to use for signature
profiling when <code>input</code> is a <code>SummarizedExperiment</code>. Required only for
input data of the class <code>SummarizedExperiment</code>. If null, the assay
used will be <code>"counts"</code>. The default is <code>NULL.</code></p></dd>


<dt>algorithm</dt>
<dd><p>a vector of algorithms to run, or character string if only
one is desired. The default is <code>c("GSVA", "ssGSEA", "ASSIGN",
"PLAGE", "Zscore", "singscore")</code>.</p></dd>


<dt>showColumnNames</dt>
<dd><p>logical. Setting <code>showColumnNames = TRUE</code> will
show the column names (i.e. sample names) on the heatmap. The default is
<code>TRUE</code>.</p></dd>


<dt>showRowNames</dt>
<dd><p>logical. Setting <code>showColumnNames = TRUE</code> will
show the row names (i.e. signature names) on the heatmap. The default is
<code>TRUE</code>.</p></dd>


<dt>scale</dt>
<dd><p>logical. Setting <code>scale = TRUE</code> scales the signature data.
The default is <code>FALSE</code>.</p></dd>


<dt>colorSets</dt>
<dd><p>a vector of names listing the color sets in the order
that they should be used in creating the heatmap. By default, this function
will use the color sets in the order listed in <code>Usage</code> for annotation
information. You may replace the default with the same collection of sets
in order that you want to use them, or provide custom color sets with the
<code>colList</code> parameter.</p></dd>


<dt>choose_color</dt>
<dd><p>a vector of color names to be interpolated for the
heatmap gradient, or a <code>colorRamp</code> function produced by
<code><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">circlize::colorRamp2</a></code>. The default is <code>c("blue", "gray95", "red")</code>.</p></dd>


<dt>colList</dt>
<dd><p>a named <code>list</code> of named vectors specifying custom color
information to
pass to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>. The list should have as many
elements as there are annotation columns, and each element name should
correspond exactly with the name of each annotation column.
The colors in the vector elements should be named according to the
levels of the factor in that column's annotation data if the annotation
is discrete, or it should be produced with <code><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">circlize::colorRamp2</a></code>
if the annotation is continuous.
By default, <code>ColorBrewer</code> color sets will be used.
See the the parameter <code>colorSets</code> for additional details.</p></dd>


<dt>show.pb</dt>
<dd><p>logical, whether warnings and other output
from the profiling should be suppressed (including progress bar output).
Default is <code>FALSE</code>.</p></dd>


<dt>parallel.sz</dt>
<dd><p>an integer identifying the number of processors to use
when running the calculations in parallel for the GSVA and ssGSEA algorithms.
If <code>parallel.sz = 0</code>, all cores are used. The default is <code>0</code>.</p></dd>


<dt>output</dt>
<dd><p>a character string specifying whether the outputted plot
should be a <code>"heatmap"</code> or <code>"boxplot"</code>. The default is
<code>"heatmap"</code>.</p></dd>


<dt>num.boot</dt>
<dd><p>an integer indicating the number of times to bootstrap the
data.</p></dd>


<dt>column_order</dt>
<dd><p>a vector of character strings indicating the order in
which to manually arrange the heatmap columns. Default is <code>NULL</code>,
such that column order is automatically determined via clustering.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A heatmap or boxplot for each signature specified comparing
the enumerated algorithms.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">compareAlgs</span><span class="op">(</span><span class="va">TB_indian</span>,</span></span>
<span class="r-in"><span>            signatures <span class="op">=</span> <span class="va">TBsignatures</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gliddon_OD_3"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>            annotationColName <span class="op">=</span> <span class="st">"label"</span>,</span></span>
<span class="r-in"><span>            algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ssGSEA"</span>, <span class="st">"PLAGE"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            scale <span class="op">=</span> <span class="cn">TRUE</span>, parallel.sz <span class="op">=</span> <span class="fl">1</span>, output <span class="op">=</span> <span class="st">"heatmap"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Parameter update_genes is TRUE. Gene names will be updated.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running ssGSEA</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 genes with constant expression values throuhgout the samples.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running PLAGE</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 genes with constant expression values throuhgout the samples.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Since argument method!="ssgsea", genes with constant expression values are discarded.</span>
<span class="r-plt img"><img src="compareAlgs-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Site created by Aubrey R. Odom.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

